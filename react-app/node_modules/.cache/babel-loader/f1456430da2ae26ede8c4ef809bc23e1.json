{"ast":null,"code":"import _objectSpread from \"/Users/zoezhao/Desktop/CS 157B/dsf/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/Users/zoezhao/Desktop/CS 157B/dsf/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/zoezhao/Desktop/CS 157B/dsf/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/zoezhao/Desktop/CS 157B/dsf/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/zoezhao/Desktop/CS 157B/dsf/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/zoezhao/Desktop/CS 157B/dsf/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/zoezhao/Desktop/CS 157B/dsf/src/component/UserProfile/HistoryBox/HistoryBox.js\";\nimport React, { Component } from 'react';\nimport UserStoreService from \"../../../common/services/User/UserStoreService\";\nimport userService from \"../../../common/services/User/UserService\";\nimport Modal from '@material-ui/core/Modal';\nimport Login from \"../../Authentication/Login/Login\";\nimport \"./HistoryBox.css\";\n\nvar HistoryBox =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(HistoryBox, _Component);\n\n  function HistoryBox() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, HistoryBox);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(HistoryBox)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      orderHistoryDetail: [],\n      cancelButton: false,\n      ifcancellable: null,\n      status: _this.props.orderStatus,\n      open: false,\n      addReview: null\n    };\n\n    _this.handleCancel = function () {\n      _this.setState({\n        status: 'canceled',\n        ifcancellable: true\n      });\n\n      console.log(_this.props.orderId);\n      var body = {\n        order_id: _this.props.orderId\n      }; // console.log(body.authorization, \"token\")\n\n      userService.order_cancel(JSON.stringify(body)).then(function (data) {\n        console.log(data);\n        alert(\"Cancel Order Succeed!\");\n      }).catch(function (error) {\n        alert(error.message);\n      });\n    };\n\n    _this.handleClose = function () {\n      _this.setState({\n        open: false\n      });\n    };\n\n    _this.handleReview = function (itemId, index) {\n      _this.setState({\n        open: true,\n        addReview: {\n          index: index,\n          itemId: itemId\n        }\n      });\n    };\n\n    _this.handleSubmit = function () {\n      console.log(_this.state.addReview.itemId);\n      console.log(_this.props.orderId);\n      console.log(document.getElementById('reviewBox').value); // console.log(document.getElementById('reviewBox').value, \"review\")\n      // console.log(itemid, \"item id\")\n\n      _this.handleClose(); // // event.preventDefault();\n\n\n      var body = {\n        order_id: _this.props.orderId,\n        item_id: _this.state.addReview.itemId,\n        comment: document.getElementById('reviewBox').value\n      };\n      userService.get_reviewinfo(JSON.stringify(body)).then(function (data) {\n        console.log(data, \"data\");\n        _this.state.orderHistoryDetail[_this.state.addReview.index].reviewed = true;\n        console.log(_this.state.orderHistoryDetail, \"check status\"); //   this.setState({ifReviewed: true})\n      }).catch(function (error) {\n        alert(error.message);\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(HistoryBox, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var body = {\n        order_id: this.props.orderId\n      }; // console.log(body.authorization, \"token\")\n\n      userService.getOrderHistoryDetail(JSON.stringify(body)).then(function (data) {\n        console.log(data);\n\n        _this2.setState({\n          orderHistoryDetail: data.orderdetail,\n          ifcancellable: !data.ifcancellable\n        });\n\n        var pair = {\n          reviewed: false\n        };\n\n        for (var i = 0; i < _this2.state.orderHistoryDetail.length; i++) {\n          _this2.state.orderHistoryDetail[i] = _objectSpread({}, _this2.state.orderHistoryDetail[i], pair);\n        } //this.state.orderHistoryDetail = {...this.state.orderHistoryDetail, ...pair};\n\n\n        console.log(_this2.state.orderHistoryDetail, \"orderHistory\");\n      }).catch(function (error) {\n        alert(error.message);\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111\n        },\n        __self: this\n      }, React.createElement(Modal, {\n        \"aria-labelledby\": \"sm snoimple-modal-title\",\n        \"aria-describedby\": \"simple-modal-description\",\n        open: this.state.open,\n        onClose: function onClose() {\n          return _this3.handleClose();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 118\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"loginbox reviewbox\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119\n        },\n        __self: this\n      }, React.createElement(\"textarea\", {\n        rows: \"10\",\n        cols: \"50\",\n        id: \"reviewBox\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121\n        },\n        __self: this\n      }), React.createElement(\"input\", {\n        type: \"submit\",\n        name: \"\",\n        value: \"Submit Review\",\n        onClick: this.handleSubmit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123\n        },\n        __self: this\n      })))), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        className: \"borderexample\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"text-muted m-b-30 freeFont\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132\n        },\n        __self: this\n      }, \"OrderId: \", this.props.orderId), React.createElement(\"div\", {\n        className: \"text-muted m-b-30 freeFont\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }, \"OrderStatus: \", this.state.status), React.createElement(\"div\", {\n        className: \"text-muted m-b-30 freeFont\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }, \"Date: \", this.props.orderDate), React.createElement(\"div\", {\n        className: \"text-muted m-b-30 freeFont\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }, \"TotalPrice: \", this.props.totalPrice.toFixed(2), \" \")), React.createElement(\"div\", {\n        className: \"row clearfix\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-md-12 column\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147\n        },\n        __self: this\n      }, React.createElement(\"table\", {\n        className: \"table table-bordered table-hover\",\n        id: \"tab_logic\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148\n        },\n        __self: this\n      }, React.createElement(\"thead\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }, React.createElement(\"tr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, React.createElement(\"th\", {\n        className: \"text-center freeFont\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155\n        },\n        __self: this\n      }, \" Picture\"), React.createElement(\"th\", {\n        className: \"text-center freeFont\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156\n        },\n        __self: this\n      }, \" Name\"), React.createElement(\"th\", {\n        className: \"text-center freeFont\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }, \" Price\"), React.createElement(\"th\", {\n        className: \"text-center freeFont\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158\n        },\n        __self: this\n      }, \" Quantity\"), React.createElement(\"th\", {\n        className: \"text-center freeFont\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159\n        },\n        __self: this\n      }, \" Add Review\"))), React.createElement(\"tbody\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      }, this.state.orderHistoryDetail.map(function (item, idx) {\n        return React.createElement(\"tr\", {\n          id: \"addr0\",\n          key: item.item_id,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 164\n          },\n          __self: this\n        }, React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 166\n          },\n          __self: this\n        }, React.createElement(\"img\", {\n          className: \"rounded managerpicsize imagesize \",\n          src: item.picurl,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 167\n          },\n          __self: this\n        })), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 169\n          },\n          __self: this\n        }, React.createElement(\"p\", {\n          className: \"fontsize\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 170\n          },\n          __self: this\n        }, item.name)), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 172\n          },\n          __self: this\n        }, React.createElement(\"p\", {\n          className: \"fontsize\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 173\n          },\n          __self: this\n        }, \" \", item.price)), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 175\n          },\n          __self: this\n        }, React.createElement(\"p\", {\n          className: \"fontsize\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 176\n          },\n          __self: this\n        }, item.quantity)), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 178\n          },\n          __self: this\n        }, React.createElement(\"button\", {\n          onClick: function onClick() {\n            return _this3.handleReview(item.item_id, idx);\n          },\n          className: \" btn btn-success\",\n          disabled: item.reviewed || !item.reviewable,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 179\n          },\n          __self: this\n        }, \"Add Review\")));\n      }))), React.createElement(\"button\", {\n        onClick: this.handleCancel,\n        className: \" btn btn-danger pull-right mb-3\",\n        disabled: this.state.ifcancellable,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192\n        },\n        __self: this\n      }, \"Cancel Order\"))));\n    }\n  }]);\n\n  return HistoryBox;\n}(Component);\n\nexport default HistoryBox;","map":{"version":3,"sources":["/Users/zoezhao/Desktop/CS 157B/dsf/src/component/UserProfile/HistoryBox/HistoryBox.js"],"names":["React","Component","UserStoreService","userService","Modal","Login","HistoryBox","state","orderHistoryDetail","cancelButton","ifcancellable","status","props","orderStatus","open","addReview","handleCancel","setState","console","log","orderId","body","order_id","order_cancel","JSON","stringify","then","data","alert","catch","error","message","handleClose","handleReview","itemId","index","handleSubmit","document","getElementById","value","item_id","comment","get_reviewinfo","reviewed","getOrderHistoryDetail","orderdetail","pair","i","length","orderDate","totalPrice","toFixed","map","item","idx","picurl","name","price","quantity","reviewable"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,IAAeC,SAAf,QAA+B,OAA/B;AACA,OAAOC,gBAAP,MAA6B,gDAA7B;AACA,OAAOC,WAAP,MAAwB,2CAAxB;AACA,OAAOC,KAAP,MAAkB,yBAAlB;AACA,OAAOC,KAAP,MAAkB,kCAAlB;AACA,OAAO,kBAAP;;IAGMC,U;;;;;;;;;;;;;;;;;UAEFC,K,GAAQ;AAEJC,MAAAA,kBAAkB,EAAE,EAFhB;AAGJC,MAAAA,YAAY,EAAE,KAHV;AAIJC,MAAAA,aAAa,EAAE,IAJX;AAKJC,MAAAA,MAAM,EAAE,MAAKC,KAAL,CAAWC,WALf;AAMJC,MAAAA,IAAI,EAAE,KANF;AAOJC,MAAAA,SAAS,EAAE;AAPP,K;;UAiCRC,Y,GAAe,YAAM;AAEjB,YAAKC,QAAL,CAAc;AAACN,QAAAA,MAAM,EAAE,UAAT;AAAqBD,QAAAA,aAAa,EAAE;AAApC,OAAd;;AAEAQ,MAAAA,OAAO,CAACC,GAAR,CAAY,MAAKP,KAAL,CAAWQ,OAAvB;AACA,UAAIC,IAAI,GAAG;AACPC,QAAAA,QAAQ,EAAE,MAAKV,KAAL,CAAWQ;AADd,OAAX,CALiB,CAQjB;;AACAjB,MAAAA,WAAW,CAACoB,YAAZ,CAAyBC,IAAI,CAACC,SAAL,CAAeJ,IAAf,CAAzB,EAA+CK,IAA/C,CAAoD,UAACC,IAAD,EAAU;AAC1DT,QAAAA,OAAO,CAACC,GAAR,CAAYQ,IAAZ;AACAC,QAAAA,KAAK,CAAC,uBAAD,CAAL;AACH,OAHD,EAGGC,KAHH,CAGS,UAACC,KAAD,EAAW;AAChBF,QAAAA,KAAK,CAACE,KAAK,CAACC,OAAP,CAAL;AACH,OALD;AAOH,K;;UACDC,W,GAAc,YAAM;AAEhB,YAAKf,QAAL,CAAc;AAEVH,QAAAA,IAAI,EAAE;AAFI,OAAd;AAIH,K;;UACDmB,Y,GAAe,UAACC,MAAD,EAASC,KAAT,EAAmB;AAE9B,YAAKlB,QAAL,CAAc;AACVH,QAAAA,IAAI,EAAE,IADI;AAEVC,QAAAA,SAAS,EAAE;AACPoB,UAAAA,KAAK,EAAEA,KADA;AAEPD,UAAAA,MAAM,EAAEA;AAFD;AAFD,OAAd;AAOH,K;;UACDE,Y,GAAe,YAAM;AACjBlB,MAAAA,OAAO,CAACC,GAAR,CAAY,MAAKZ,KAAL,CAAWQ,SAAX,CAAqBmB,MAAjC;AACAhB,MAAAA,OAAO,CAACC,GAAR,CAAY,MAAKP,KAAL,CAAWQ,OAAvB;AACAF,MAAAA,OAAO,CAACC,GAAR,CAAYkB,QAAQ,CAACC,cAAT,CAAwB,WAAxB,EAAqCC,KAAjD,EAHiB,CAIjB;AACA;;AACC,YAAKP,WAAL,GANgB,CAOjB;;;AACA,UAAIX,IAAI,GAAG;AACPC,QAAAA,QAAQ,EAAE,MAAKV,KAAL,CAAWQ,OADd;AAEPoB,QAAAA,OAAO,EAAE,MAAKjC,KAAL,CAAWQ,SAAX,CAAqBmB,MAFvB;AAGPO,QAAAA,OAAO,EAAEJ,QAAQ,CAACC,cAAT,CAAwB,WAAxB,EAAqCC;AAHvC,OAAX;AAMApC,MAAAA,WAAW,CAACuC,cAAZ,CAA2BlB,IAAI,CAACC,SAAL,CAAeJ,IAAf,CAA3B,EAAiDK,IAAjD,CAAsD,UAACC,IAAD,EAAU;AAE5DT,QAAAA,OAAO,CAACC,GAAR,CAAYQ,IAAZ,EAAkB,MAAlB;AAGC,cAAKpB,KAAL,CAAWC,kBAAX,CAA8B,MAAKD,KAAL,CAAWQ,SAAX,CAAqBoB,KAAnD,EAA0DQ,QAA1D,GAAqE,IAArE;AAEAzB,QAAAA,OAAO,CAACC,GAAR,CAAY,MAAKZ,KAAL,CAAWC,kBAAvB,EAA2C,cAA3C,EAP2D,CAQ/D;AAEA,OAVD,EAUGqB,KAVH,CAUS,UAACC,KAAD,EAAW;AAChBF,QAAAA,KAAK,CAACE,KAAK,CAACC,OAAP,CAAL;AACH,OAZD;AAcH,K;;;;;;;wCApFmB;AAAA;;AAEhB,UAAIV,IAAI,GAAG;AACPC,QAAAA,QAAQ,EAAE,KAAKV,KAAL,CAAWQ;AADd,OAAX,CAFgB,CAKhB;;AACAjB,MAAAA,WAAW,CAACyC,qBAAZ,CAAkCpB,IAAI,CAACC,SAAL,CAAeJ,IAAf,CAAlC,EAAwDK,IAAxD,CAA6D,UAACC,IAAD,EAAU;AACnET,QAAAA,OAAO,CAACC,GAAR,CAAYQ,IAAZ;;AAEA,QAAA,MAAI,CAACV,QAAL,CAAc;AAACT,UAAAA,kBAAkB,EAAEmB,IAAI,CAACkB,WAA1B;AAAuCnC,UAAAA,aAAa,EAAE,CAACiB,IAAI,CAACjB;AAA5D,SAAd;;AACA,YAAIoC,IAAI,GAAG;AAACH,UAAAA,QAAQ,EAAE;AAAX,SAAX;;AACA,aAAK,IAAII,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,MAAI,CAACxC,KAAL,CAAWC,kBAAX,CAA8BwC,MAAlD,EAA0DD,CAAC,EAA3D,EAA+D;AAC3D,UAAA,MAAI,CAACxC,KAAL,CAAWC,kBAAX,CAA8BuC,CAA9B,sBAAuC,MAAI,CAACxC,KAAL,CAAWC,kBAAX,CAA8BuC,CAA9B,CAAvC,EAA4ED,IAA5E;AACH,SAPkE,CAQnE;;;AACA5B,QAAAA,OAAO,CAACC,GAAR,CAAY,MAAI,CAACZ,KAAL,CAAWC,kBAAvB,EAA2C,cAA3C;AACH,OAVD,EAUGqB,KAVH,CAUS,UAACC,KAAD,EAAW;AAChBF,QAAAA,KAAK,CAACE,KAAK,CAACC,OAAP,CAAL;AACH,OAZD;AAcH;;;6BAmEQ;AAAA;;AACL,aACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI,oBAAC,KAAD;AACI,2BAAgB,yBADpB;AAEI,4BAAiB,0BAFrB;AAGI,QAAA,IAAI,EAAE,KAAKxB,KAAL,CAAWO,IAHrB;AAII,QAAA,OAAO,EAAE;AAAA,iBAAM,MAAI,CAACkB,WAAL,EAAN;AAAA,SAJb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAMI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAK,QAAA,SAAS,EAAC,oBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAEA;AAAU,QAAA,IAAI,EAAC,IAAf;AAAoB,QAAA,IAAI,EAAC,IAAzB;AAA8B,QAAA,EAAE,EAAC,WAAjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFA,EAII;AAAO,QAAA,IAAI,EAAC,QAAZ;AAAqB,QAAA,IAAI,EAAC,EAA1B;AAA6B,QAAA,KAAK,EAAC,eAAnC;AAAmD,QAAA,OAAO,EAAE,KAAKI,YAAjE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAJJ,CADJ,CANJ,CADJ,EAmBI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAG,QAAA,SAAS,EAAC,eAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,EAEI;AAAK,QAAA,SAAS,EAAC,4BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAEc,KAAKxB,KAAL,CAAWQ,OAFzB,CAFJ,EAMI;AAAK,QAAA,SAAS,EAAC,4BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BACkB,KAAKb,KAAL,CAAWI,MAD7B,CANJ,EASI;AAAK,QAAA,SAAS,EAAC,4BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACW,KAAKC,KAAL,CAAWqC,SADtB,CATJ,EAYI;AAAK,QAAA,SAAS,EAAC,4BAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBACiB,KAAKrC,KAAL,CAAWsC,UAAX,CAAsBC,OAAtB,CAA8B,CAA9B,CADjB,MAZJ,CAnBJ,EAmCI;AAAK,QAAA,SAAS,EAAC,cAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAK,QAAA,SAAS,EAAC,kBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AACI,QAAA,SAAS,EAAC,kCADd;AAEI,QAAA,EAAE,EAAC,WAFP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAII;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAEI;AAAI,QAAA,SAAS,EAAC,sBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAFJ,EAGI;AAAI,QAAA,SAAS,EAAC,sBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAHJ,EAII;AAAI,QAAA,SAAS,EAAC,sBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAJJ,EAKI;AAAI,QAAA,SAAS,EAAC,sBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBALJ,EAMI;AAAI,QAAA,SAAS,EAAC,sBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBANJ,CADA,CAJJ,EAcI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACC,KAAK5C,KAAL,CAAWC,kBAAX,CAA8B4C,GAA9B,CAAkC,UAACC,IAAD,EAAOC,GAAP;AAAA,eAC/B;AAAI,UAAA,EAAE,EAAC,OAAP;AAAe,UAAA,GAAG,EAAED,IAAI,CAACb,OAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI;AAAK,UAAA,SAAS,EAAC,mCAAf;AAAmD,UAAA,GAAG,EAAEa,IAAI,CAACE,MAA7D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADJ,CAFJ,EAKI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI;AAAG,UAAA,SAAS,EAAC,UAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAAyBF,IAAI,CAACG,IAA9B,CADJ,CALJ,EAQI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI;AAAG,UAAA,SAAS,EAAC,UAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAA0BH,IAAI,CAACI,KAA/B,CADJ,CARJ,EAWI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI;AAAG,UAAA,SAAS,EAAC,UAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAAyBJ,IAAI,CAACK,QAA9B,CADJ,CAXJ,EAcI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI;AACI,UAAA,OAAO,EAAE;AAAA,mBAAM,MAAI,CAACzB,YAAL,CAAkBoB,IAAI,CAACb,OAAvB,EAAgCc,GAAhC,CAAN;AAAA,WADb;AAEI,UAAA,SAAS,EAAC,kBAFd;AAGI,UAAA,QAAQ,EAAED,IAAI,CAACV,QAAL,IAAiB,CAACU,IAAI,CAACM,UAHrC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADJ,CAdJ,CAD+B;AAAA,OAAlC,CADD,CAdJ,CADJ,EA6CI;AACI,QAAA,OAAO,EAAE,KAAK3C,YADlB;AAEI,QAAA,SAAS,EAAC,iCAFd;AAGI,QAAA,QAAQ,EAAE,KAAKT,KAAL,CAAWG,aAHzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBA7CJ,CADJ,CAnCJ,CADJ;AAkGH;;;;EAvMoBT,S;;AA0MzB,eAAeK,UAAf","sourcesContent":["import React, {Component} from 'react';\nimport UserStoreService from \"../../../common/services/User/UserStoreService\";\nimport userService from \"../../../common/services/User/UserService\";\nimport Modal from '@material-ui/core/Modal';\nimport Login from \"../../Authentication/Login/Login\";\nimport \"./HistoryBox.css\";\n\n\nclass HistoryBox extends Component {\n\n    state = {\n\n        orderHistoryDetail: [],\n        cancelButton: false,\n        ifcancellable: null,\n        status: this.props.orderStatus,\n        open: false,\n        addReview: null\n    };\n\n\n    componentDidMount() {\n\n        let body = {\n            order_id: this.props.orderId,\n        };\n        // console.log(body.authorization, \"token\")\n        userService.getOrderHistoryDetail(JSON.stringify(body)).then((data) => {\n            console.log(data);\n\n            this.setState({orderHistoryDetail: data.orderdetail, ifcancellable: !data.ifcancellable});\n            var pair = {reviewed: false};\n            for (let i = 0; i < this.state.orderHistoryDetail.length; i++) {\n                this.state.orderHistoryDetail[i] = {...this.state.orderHistoryDetail[i], ...pair};\n            }\n            //this.state.orderHistoryDetail = {...this.state.orderHistoryDetail, ...pair};\n            console.log(this.state.orderHistoryDetail, \"orderHistory\")\n        }).catch((error) => {\n            alert(error.message);\n        });\n\n    }\n\n    handleCancel = () => {\n\n        this.setState({status: 'canceled', ifcancellable: true});\n\n        console.log(this.props.orderId)\n        let body = {\n            order_id: this.props.orderId,\n        };\n        // console.log(body.authorization, \"token\")\n        userService.order_cancel(JSON.stringify(body)).then((data) => {\n            console.log(data);\n            alert(\"Cancel Order Succeed!\");\n        }).catch((error) => {\n            alert(error.message);\n        });\n\n    };\n    handleClose = () => {\n\n        this.setState({\n\n            open: false\n        });\n    };\n    handleReview = (itemId, index) => {\n\n        this.setState({\n            open: true,\n            addReview: {\n                index: index,\n                itemId: itemId\n            }\n        });\n    };\n    handleSubmit = () => {\n        console.log(this.state.addReview.itemId)\n        console.log(this.props.orderId)\n        console.log(document.getElementById('reviewBox').value)\n        // console.log(document.getElementById('reviewBox').value, \"review\")\n        // console.log(itemid, \"item id\")\n         this.handleClose();\n        // // event.preventDefault();\n        let body = {\n            order_id: this.props.orderId,\n            item_id: this.state.addReview.itemId,\n            comment: document.getElementById('reviewBox').value,\n        };\n\n        userService.get_reviewinfo(JSON.stringify(body)).then((data) => {\n\n            console.log(data, \"data\");\n\n\n             this.state.orderHistoryDetail[this.state.addReview.index].reviewed = true;\n\n             console.log(this.state.orderHistoryDetail, \"check status\")\n         //   this.setState({ifReviewed: true})\n\n        }).catch((error) => {\n            alert(error.message);\n        });\n\n    };\n\n\n    render() {\n        return (\n            <div>\n                <Modal\n                    aria-labelledby=\"sm snoimple-modal-title\"\n                    aria-describedby=\"simple-modal-description\"\n                    open={this.state.open}\n                    onClose={() => this.handleClose()}\n                >\n                    <div>\n                        <div className=\"loginbox reviewbox\">\n\n                        <textarea rows=\"10\" cols=\"50\" id='reviewBox'>\n                        </textarea>\n                            <input type=\"submit\" name=\"\" value=\"Submit Review\" onClick={this.handleSubmit}>\n                            </input>\n                        </div>\n\n                    </div>\n                </Modal>\n\n                <div>\n                    <p className=\"borderexample\"></p>\n                    <div className=\"text-muted m-b-30 freeFont\">\n\n                        OrderId: {this.props.orderId}\n                    </div>\n                    <div className=\"text-muted m-b-30 freeFont\">\n                        OrderStatus: {this.state.status}\n                    </div>\n                    <div className=\"text-muted m-b-30 freeFont\">\n                        Date: {this.props.orderDate}\n                    </div>\n                    <div className=\"text-muted m-b-30 freeFont\">\n                        TotalPrice: {this.props.totalPrice.toFixed(2)} </div>\n                </div>\n\n                <div className=\"row clearfix\">\n                    <div className=\"col-md-12 column\">\n                        <table\n                            className=\"table table-bordered table-hover\"\n                            id=\"tab_logic\"\n                        >\n                            <thead>\n                            <tr>\n\n                                <th className=\"text-center freeFont\"> Picture</th>\n                                <th className=\"text-center freeFont\"> Name</th>\n                                <th className=\"text-center freeFont\"> Price</th>\n                                <th className=\"text-center freeFont\"> Quantity</th>\n                                <th className=\"text-center freeFont\"> Add Review</th>\n                            </tr>\n                            </thead>\n                            <tbody>\n                            {this.state.orderHistoryDetail.map((item, idx) => (\n                                <tr id=\"addr0\" key={item.item_id}>\n\n                                    <td>\n                                        <img className=\"rounded managerpicsize imagesize \" src={item.picurl}/>\n                                    </td>\n                                    <td>\n                                        <p className=\"fontsize\">{item.name}</p>\n                                    </td>\n                                    <td>\n                                        <p className=\"fontsize\"> {item.price}</p>\n                                    </td>\n                                    <td>\n                                        <p className=\"fontsize\">{item.quantity}</p>\n                                    </td>\n                                    <td>\n                                        <button\n                                            onClick={() => this.handleReview(item.item_id, idx)}\n                                            className=\" btn btn-success\"\n                                            disabled={item.reviewed || !item.reviewable}\n                                        >\n                                            Add Review\n                                        </button>\n                                    </td>\n                                </tr>\n                            ))}\n                            </tbody>\n                        </table>\n\n                        <button\n                            onClick={this.handleCancel}\n                            className=\" btn btn-danger pull-right mb-3\"\n                            disabled={this.state.ifcancellable}\n                        >\n                            Cancel Order\n                        </button>\n\n\n                    </div>\n                </div>\n\n            </div>\n\n        )\n\n    };\n}\n\nexport default HistoryBox;"]},"metadata":{},"sourceType":"module"}